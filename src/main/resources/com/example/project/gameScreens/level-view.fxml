<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>

<StackPane fx:id="gameStack" stylesheets="@level-styles.css"
           xmlns="http://javafx.com/javafx/17.0.12"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="com.example.project.controllers.gameScreens.LevelController">

    <!-- Background -->
    <ImageView fx:id="backgroundImage" managed="false" mouseTransparent="true" preserveRatio="false" StackPane.alignment="CENTER">
        <image>
            <Image url="@backgroundImage.png" />
        </image>
    </ImageView>

    <!-- Tile stand (bottom center) -->
    <ImageView fx:id="tileStandImage" mouseTransparent="true" preserveRatio="true" StackPane.alignment="BOTTOM_CENTER">
        <StackPane.margin>
            <Insets bottom="550" />
        </StackPane.margin>
        <image>
            <Image url="@tileStand.png" />
        </image>
    </ImageView>

    <!-- Tile rack (slightly above stand) -->
    <ImageView fx:id="tileRackImage" mouseTransparent="true" preserveRatio="true" StackPane.alignment="BOTTOM_CENTER">
        <StackPane.margin>
            <Insets bottom="840" />
        </StackPane.margin>
        <image>
            <Image url="@tileRack.png" />
        </image>
    </ImageView>

    <!-- Tile rack rectangle (above rack) -->
    <ImageView fx:id="tileRackRectangleImage" mouseTransparent="true" preserveRatio="true" StackPane.alignment="BOTTOM_CENTER">
        <StackPane.margin>
            <Insets bottom="860" />
        </StackPane.margin>
        <image>
            <Image url="@tileRackRectangle.png" />
        </image>
    </ImageView>

    <!-- Foreground content -->
    <BorderPane>

        <!-- Left Sidebar -->
        <left>
            <VBox fx:id="sidebar" alignment="TOP_CENTER" prefHeight="562.0" prefWidth="301.0" spacing="20" styleClass="left-panel">
                <padding>
                    <Insets bottom="20" left="20" right="20" top="20" />
                </padding>

                <Label fx:id="scoreHeaderLabel" styleClass="score-header" text="To Beat!" />
                <Label fx:id="scoreToBeatLabel" styleClass="score-box" text="9,999,999" />

                <!-- Added: required score label -->
                <Label fx:id="scoreRequiredText" styleClass="info-label" text="required: 0" />

                <Separator />

                <Label fx:id="yourScoreHeaderLabel" styleClass="score-header" text="Your Score" />
                <Label fx:id="currentScoreLabel" styleClass="your-score-box" text="0" />

                <!-- Added: current level points label -->
                <Label fx:id="levelPointsText" styleClass="info-label" text="0" />

                <Label fx:id="comboHeaderLabel" prefHeight="44.0" prefWidth="201.0" styleClass="score-header" text="Combo" />
                <HBox alignment="CENTER" spacing="8" styleClass="combo-box">
                    <Label fx:id="comboCountLabel" styleClass="combo-bubble-blue" text="1" />
                    <Label styleClass="combo-x" text="×" />
                    <Label fx:id="comboMultiplierLabel" styleClass="combo-bubble-red" text="2" />
                </HBox>
            </VBox>
        </left>

        <!-- Top Bar -->
        <top>
            <VBox alignment="CENTER" spacing="10">
                <padding>
                    <Insets bottom="20" left="20" right="20" top="20" />
                </padding>
                <Label styleClass="heading" text="Level 1" />

                <!-- FIX: renamed fx:id to match controller -->
                <HBox fx:id="upgradeTilesContainer" alignment="CENTER" spacing="10" />

                <HBox alignment="CENTER_RIGHT" spacing="10">
                    <Button styleClass="menu-button" text="Sound" />
                    <Button styleClass="menu-button" text="Customise" />
                </HBox>
            </VBox>
        </top>

        <!-- Center Game Area -->
        <center>
            <VBox alignment="CENTER" spacing="20" translateX="-62" translateY="10">

                <!-- Win/Loss text -->
                <Label fx:id="levelWonLostText" text="" styleClass="info-label" alignment="CENTER" />

                <HBox fx:id="wordViewHBox" alignment="CENTER" spacing="9" translateY="24" />

                <HBox alignment="CENTER" spacing="50" translateX="60" translateY="70">
                    <!-- Plays -->
                    <VBox alignment="CENTER" styleClass="control-container" translateX="-80" translateY="30">
                        <Label styleClass="control-label" text="Plays" />
                        <HBox alignment="CENTER" spacing="10">
                            <Label fx:id="playsLeftLabel" styleClass="control-number" text="9" />
                            <Button fx:id="playButton" onAction="#onPlayButton" styleClass="circle-button" text="▶" translateX="10" />
                        </HBox>
                    </VBox>

                    <!-- Redraws -->
                    <VBox alignment="CENTER" styleClass="control-container" translateX="-80" translateY="30">
                        <Label styleClass="control-label" text="Redraws" />
                        <HBox alignment="CENTER" spacing="10">
                            <Label fx:id="redrawsLeftLabel" styleClass="control-number" text="9" />
                            <Button fx:id="redrawButton" onAction="#onRedrawButton" styleClass="circle-button" text="⟳" />
                        </HBox>
                        <HBox.margin>
                            <Insets />
                        </HBox.margin>
                        <padding>
                            <Insets bottom="20.0" />
                        </padding>
                    </VBox>
                </HBox>

                <HBox fx:id="tileRackContainer" alignment="CENTER" spacing="14" translateY="110"/>
                <Button fx:id="confirmRedrawButton" onAction="#onConfirmRedrawButton" styleClass="control-button" text="Confirm Redraw" translateX="400" translateY="-80" />

            </VBox>
        </center>

        <!-- Bottom Right -->
        <bottom>
            <HBox alignment="BOTTOM_RIGHT">
                <padding>
                    <Insets bottom="20" left="20" right="20" top="20" />
                </padding>
                <VBox fx:id="redrawContainer" alignment="BOTTOM_CENTER" prefHeight="300" prefWidth="150" spacing="10" />
            </HBox>
        </bottom>

        <!-- Right -->
        <right>
            <VBox alignment="TOP_CENTER">
                <padding>
                    <Insets bottom="20" left="20" right="20" top="20" />
                </padding>
                <Button onAction="#onSkipButton" text="(Dev only) Skip to shop">
                    <HBox.margin>
                        <Insets left="200" />
                    </HBox.margin>
                </Button>
            </VBox>
        </right>

    </BorderPane>
</StackPane>